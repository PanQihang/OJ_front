


var SelectColor = (function () {
    var d = null;
    var c = [];
    var b = {
        elem: ".select-color",
        range: "|",
        left: 0,
        index: 0,
        data: []
    };
    var e = Object.assign || function (j) {
        for (var g = 1; g < arguments.length; g++) {
            var h = arguments[g];
            for (var f in h) {
                if (Object.prototype.hasOwnProperty.call(h, f)) {
                    j[f] = h[f]
                }
            }
        }
        return j
    };

    function a() {
        d = e({}, b, arguments[0]);
        var f = this;
        this.index = d.index;
        this.createElement(function () {
            f.render()
        })
    }

    a.prototype.createElement = function (f) {
        this.mainbox = document.createElement("div");
        this.nav = document.createElement("ul");
        this.box = document.createElement("div");
        this.colorlist = document.createElement("ul");
        $(this.mainbox).addClass("color-group-wrapper color-dropdown-wrapper");
        $(this.nav).addClass("color-group-panel");
        $(this.box).addClass("colors-panel");
        $(this.colorlist).addClass("color-list");
        $(this.box).html('<p class="colors-panel-title"></p>');
        $(this.box).append(this.colorlist);
        $(this.mainbox).append(this.nav);
        $(this.mainbox).append(this.box);
        f && f()
    };
    a.prototype.render = function () {
        var l = this;
        var h = $(this.mainbox);
        var n = $(this.nav);
        var k = $(this.colorlist);
        //var g = $(d.elem);
		var g=$('#selectProblemType'); //需要添加这个列表的组件
        var f = null;
        var o = "";
        var m = "";
        for (var j = 0; j < d.data.length; j++) {
            if(d.data[j]["typeAName"] == '其它' || d.data[j]["typeAName"]=='其他')
                o += '<li class="color-tag" data-index="' + j + '">' + '<a ' +  'onclick="resetProblemType(0, \'其他\')"'+'><div class="color-block" style="background:yellow;"></div>' + "<span>" + d.data[j]["typeAName"] + "</span>" + "</a>" + "</li>"
            else
                o += '<li class="color-tag" data-index="' + j + '">' + '<a ' + (0==j ? 'onclick="resetProblemType(-1, \'全部题目\')"':'')+'><div class="color-block" style="background:yellow;"></div>' + "<span>" + d.data[j]["typeAName"] + "</span>" + "</a>" + "</li>"
        }
        n.html(o);
        k.html(this.createList());
        $("body").append(this.mainbox);
        n.find("li.color-tag").hover(function (p) {
            p.stopPropagation();
            var i = $(this).attr("data-index");
            if (i == l.index) {
                return
            }
            l.index = i;
            k.html(l.createList())
        });
        $("body").on("click", ".color-group-panel li.color-tag", function (i) {
            i.stopPropagation()
        });
        $("body").on("click", ".color-list li.color-tag", function (q) {
            q.stopPropagation();
            var p = $(this).attr("data-index");
            //var i = d.data[l.index]["typeBList"][p]["typeBName"];
            /*if (f.val() != "") {
				//c=[]
                c = f.val().split(d.range)
            } else {
                c = []
            }
            if (c.indexOf(i) != -1) {
                return
            }
            c.push(i);
            f.val(c.join(d.range));
            c.length = 0
            */
        });
        h.css({display: "none"});
        g.off("click").on("click", function(q){

            q.stopPropagation();
            f = $(this);
            if (f.val() != "") {
                c = f.val().split("|")
            }
            var p = f.offset().left + d.left;
            var i = f.offset().top + f.get(0).offsetHeight;
            h.css({position: "absolute", left: p, top: i, display: "block", zIndex: "2999"});
            $("html").off("click").on("click", function () {
                h.hide()
            })
        })
    };
    a.prototype.createList = function () {
        var h = "";
        var f = this.index;
        var j = d.data[f]["typeBList"];
        /*console.log(j);
        console.log(j.length+", "+f);
        console.log("---------------")*/
        for (var g = 0; f!=0 && g < j.length; g++) {
            h += '<li class="color-tag" data-index="' + g + '">' + '<a onclick="resetProblemType('+j[g]["typeBId"]+',\''+j[g]["typeBName"]+'\')"> <div class="color-block" style="background:white;"></div>' + "<span>" + j[g]["typeBName"] + "</span>" + "</a>" + "</li>"
        }
        return h
    };
    return a
}());
function tempFun(q) {

    q.stopPropagation();
    f = $(this);
    if (f.val() != "") {
        c = f.val().split("|")
    }
    var p = f.offset().left + d.left;
    var i = f.offset().top + f.get(0).offsetHeight;
    h.css({position: "absolute", left: p, top: i, display: "block", zIndex: "2999"});
    $("html").off("click").on("click", function () {
        h.hide()
    })
}

function resetProblemType(tid, tname){
    //对应div是动态生成的，不能通过id获取，只能通过class匹配
    $('.color-group-wrapper.color-dropdown-wrapper').hide();
	$('#problemType').val(tname);
	//console.log(tid);
    //filtrateProblemList(tid);
    //if(problemType!=tid){
        problemType=tid;
        //sortProblemList(2)
    //}

}